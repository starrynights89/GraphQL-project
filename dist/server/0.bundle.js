exports.ids=[0],exports.modules={63:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(4),a=n.n(r),s=n(5),i=n.n(s),o=n(6),u=n.n(o),c=n(7),l=n.n(c),p=n(8),d=n.n(p),h=n(0),m=n.n(h),f=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return m.a.createElement("div",{className:"error message"},e)}}]),t}(h.Component)},64:function(e,t,n){"use strict";n.d(t,"a",function(){return C});var r=n(4),a=n.n(r),s=n(5),i=n.n(s),o=n(6),u=n.n(o),c=n(7),l=n.n(c),p=n(8),d=n.n(p),h=n(50),m=n.n(h),f=n(0),v=n.n(f),g=n(12),y=n(51);function E(){var e=m()(["\n  query currentUser {\n    currentUser {\n      id\n      username\n      avatar\n    }\n  }\n"]);return E=function(){return e},e}var b=n.n(y)()(E()),C=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return v.a.createElement(g.ApolloConsumer,null,function(t){var n=t.readQuery({query:b}).currentUser;return v.a.Children.map(e,function(e){return v.a.cloneElement(e,{user:n})})})}}]),t}(f.Component)},65:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var r=n(2),a=n.n(r),s=n(4),i=n.n(s),o=n(5),u=n.n(o),c=n(6),l=n.n(c),p=n(7),d=n.n(p),h=n(8),m=n.n(h),f=n(50),v=n.n(f),g=n(0),y=n.n(g),E=n(12),b=n(51),C=n.n(b),k=n(16),w=n(63);function O(){var e=v()(["\n  query postsFeed($page: Int, $limit: Int, $username: String) { \n    postsFeed(page: $page, limit: $limit, username: $username) { \n      posts {\n        id\n        text\n        user {\n          avatar\n          username\n        }\n      }\n    }\n  }\n"]);return O=function(){return e},e}var P=C()(O()),I=function(e){function t(){return i()(this,t),l()(this,d()(t).apply(this,arguments))}return m()(t,e),u()(t,[{key:"getVariables",value:function(){var e=this.props.variables,t={page:0,limit:10};return"undefined"!==a()(e)&&("undefined"!==a()(e.page)&&(t.page=e.page),"undefined"!==a()(e.limit)&&(t.limit=e.limit)),"undefined"!==a()(e.username)&&(t.username=e.username),t}},{key:"render",value:function(){var e=this.props.children,t=this.getVariables();return y.a.createElement(E.Query,{query:P,variables:t},function(t){var n=t.loading,r=t.error,a=t.data,s=t.fetchMore;if(n)return y.a.createElement(k.a,null);if(r)return y.a.createElement(w.a,null,y.a.createElement("p",null,r.message));var i=a.postsFeed.posts;return y.a.Children.map(e,function(e){return y.a.cloneElement(e,{posts:i,fetchMore:s})})})}}]),t}(g.Component)},66:function(e,t,n){"use strict";n.d(t,"a",function(){return C});var r=n(2),a=n.n(r),s=n(4),i=n.n(s),o=n(5),u=n.n(o),c=n(6),l=n.n(c),p=n(7),d=n.n(p),h=n(23),m=n.n(h),f=n(8),v=n.n(f),g=n(9),y=n.n(g),E=n(0),b=n.n(E),C=function(e){function t(){var e,n;i()(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(a))),y()(m()(n),"handlePostContentChange",function(e){n.props.changePostContent(e.target.value)}),n}return v()(t,e),u()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.addPost,r=t.updatePost,s=t.postContent,i=t.postId;return b.a.createElement("div",{className:"postForm"},b.a.createElement("form",{onSubmit:function(t){t.preventDefault(),"undefined"!==a()(r)?r({variables:{post:{text:s},postId:i}}).then(function(){e.props.changeState()}):n({variables:{post:{text:s}}}).then(function(){e.props.changePostContent("")})}},b.a.createElement("textarea",{value:s,onChange:e.handlePostContentChange,placeholder:"Write your custom post!"}),b.a.createElement("input",{type:"submit",value:"Submit"})))}}]),t}(E.Component)},67:function(e,t,n){"use strict";n.d(t,"a",function(){return w});var r=n(4),a=n.n(r),s=n(5),i=n.n(s),o=n(6),u=n.n(o),c=n(7),l=n.n(c),p=n(8),d=n.n(p),h=n(50),m=n.n(h),f=n(0),v=n.n(f),g=n(12),y=n(16),E=n(63),b=n(51);function C(){var e=m()(["\n  query currentUser { \n    currentUser { \n      id\n      username\n      avatar\n    }\n  }\n"]);return C=function(){return e},e}var k=n.n(b)()(C()),w=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return v.a.createElement(g.Query,{query:k},function(t){var n=t.loading,r=t.error,a=t.data;if(n)return v.a.createElement(y.a,null);if(r)return v.a.createElement(E.a,null,v.a.createElement("p",null,r.message));var s=a.currentUser;return v.a.Children.map(e,function(e){return v.a.cloneElement(e,{currentUser:s})})})}}]),t}(f.Component)},68:function(e,t,n){"use strict";var r=n(4),a=n.n(r),s=n(5),i=n.n(s),o=n(6),u=n.n(o),c=n(7),l=n.n(c),p=n(8),d=n.n(p),h=n(0),m=n.n(h),f=n(23),v=n.n(f),g=n(9),y=n.n(g),E=n(2),b=n.n(E),C=n(50),k=n.n(C),w=n(12),O=(n(16),n(63),n(51)),P=n.n(O);function I(){var e=k()(["\n    query usersSearch($page: Int, $limit: Int, $text: String!) { \n        usersSearch(page: $page, limit: $limit, text: $text) { \n            users {\n                id\n                avatar\n                username\n            }\n        }\n    }\n"]);return I=function(){return e},e}var x=P()(I()),A=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"getVariables",value:function(){var e=this.props.variables,t={page:0,limit:5,text:""};return"undefined"!==b()(e)&&("undefined"!==b()(e.page)&&(t.page=e.page),"undefined"!==b()(e.limit)&&(t.limit=e.limit),"undefined"!==b()(e.text)&&(t.text=e.text)),t}},{key:"render",value:function(){var e=this.props.children,t=this.getVariables(),n=t.text.length<3;return m.a.createElement(w.Query,{query:x,variables:t,skip:n},function(n){var r=n.loading,a=n.error,s=n.data,i=n.fetchMore,o=n.refetch;if(r||a||"undefined"===b()(s))return null;var u=s.usersSearch.users;return m.a.Children.map(e,function(e){return m.a.cloneElement(e,{users:u,fetchMore:i,variables:t,refetch:o})})})}}]),t}(h.Component),S=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),y()(v()(n),"closeList",function(){n.setState({showList:!1})}),y()(v()(n),"state",{showList:n.checkLength(n.props.users)}),n}return d()(t,e),i()(t,[{key:"componentWillReceiveProps",value:function(e){this.showList(e.users)}},{key:"checkLength",value:function(e){return e.length>0&&(document.addEventListener("click",this.closeList),!0)}},{key:"showList",value:function(e){this.checkLength(e)?this.setState({showList:!0}):this.closeList()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.closeList)}},{key:"render",value:function(){var e=this.props.users;return this.state.showList&&m.a.createElement("div",{className:"result"},e.map(function(e,t){return m.a.createElement("div",{key:e.id,className:"user"},m.a.createElement("img",{src:e.avatar}),m.a.createElement("span",null,e.username))}))}}]),t}(h.Component),M=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),y()(v()(n),"state",{text:""}),y()(v()(n),"changeText",function(e){n.setState({text:e.target.value})}),n}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.state.text;return m.a.createElement("div",{className:"search"},m.a.createElement("input",{type:"text",onChange:this.changeText,value:e}),m.a.createElement(A,{variables:{text:e}},m.a.createElement(S,null)))}}]),t}(h.Component);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $(){var e=k()(["\n  mutation uploadAvatar($file: Upload!) {\n    uploadAvatar(file: $file) {\n      filename\n      url\n    }\n  }\n"]);return $=function(){return e},e}function j(){var e=k()(["\n  query currentUser { \n    currentUser { \n      id\n      username\n      avatar\n    }\n  }\n"]);return j=function(){return e},e}var q=P()(j()),L=P()($()),F=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return m.a.createElement(w.Mutation,{update:function(e,t){var n=t.data.uploadAvatar,r={query:q},a=e.readQuery(r);a.currentUser.avatar=n.url,e.writeData(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach(function(t){y()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{data:a}))},mutation:L},function(t){return m.a.Children.map(e,function(e){return m.a.cloneElement(e,{uploadAvatar:t})})})}}]),t}(h.Component),_=n(57),D=n.n(_),T=n(58),Q=n.n(T);D.a.setAppElement("#root");var U={content:{width:"400px",height:"450px",top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};var R=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),y()(v()(n),"state",{result:null,filename:null,filetype:null,src:null,error:null}),y()(v()(n),"onChange",function(e){n.setState(e)}),y()(v()(n),"uploadAvatar",function(){var e=v()(n),t=function(e){for(var t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return new Blob([r],{type:n})}(n.state.result);t.name=n.state.filename,n.props.uploadAvatar({variables:{file:t}}).then(function(){e.props.showModal()})}),y()(v()(n),"changeImage",function(){n.setState({src:null})}),n}return d()(t,e),i()(t,[{key:"render",value:function(){return m.a.createElement(D.a,{isOpen:this.props.isOpen,onRequestClose:this.props.showModal,contentLabel:"Change avatar",style:U},m.a.createElement(Q.a,{onChange:this.onChange,value:this.state}),null!==this.state.src&&m.a.createElement("button",{className:"cancelUpload",onClick:this.changeImage},"Change image"),m.a.createElement("button",{className:"uploadAvatar",onClick:this.uploadAvatar},"Save"))}}]),t}(h.Component),W=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),y()(v()(n),"state",{isOpen:!1}),y()(v()(n),"showModal",function(){n.setState({isOpen:!n.state.isOpen})}),n}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.user;return e?m.a.createElement("div",{className:"user"},m.a.createElement("img",{src:e.avatar,onClick:this.showModal}),m.a.createElement(F,null,m.a.createElement(R,{isOpen:this.state.isOpen,showModal:this.showModal})),m.a.createElement("span",null,e.username)):null}}]),t}(h.Component),H=n(64),V=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),y()(v()(n),"logout",function(){n.props.logout().then(function(){localStorage.removeItem("jwt"),n.props.client.resetStore()})}),n}return d()(t,e),i()(t,[{key:"render",value:function(){return m.a.createElement("button",{className:"logout",onClick:this.logout},"Logout")}}]),t}(h.Component),K=Object(w.withApollo)(V),G=n(59),B=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),y()(v()(n),"goHome",function(){n.props.history.push("/app")}),n}return d()(t,e),i()(t,[{key:"render",value:function(){return m.a.createElement("button",{className:"goHome",onClick:this.goHome},"Home")}}]),t}(h.Component),X=Object(G.withRouter)(B);function z(){var e=k()(["\n  mutation logout {\n    logout {\n      success\n    }\n  }\n"]);return z=function(){return e},e}var J=P()(z()),Y=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return m.a.createElement(w.Mutation,{mutation:J},function(t,n){var r=n.loading,a=n.error;return m.a.Children.map(e,function(e){return m.a.cloneElement(e,{logout:t,loading:r,error:a})})})}}]),t}(h.Component);n.d(t,"a",function(){return Z});var Z=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),i()(t,[{key:"render",value:function(){return m.a.createElement("div",{className:"topbar"},m.a.createElement("div",{className:"inner"},m.a.createElement(M,null),m.a.createElement(H.a,null,m.a.createElement(W,null))),m.a.createElement("div",{className:"buttons"},m.a.createElement(X,null),m.a.createElement(Y,null,m.a.createElement(K,{changeLoginState:this.props.changeLoginState}))))}}]),t}(h.Component)},69:function(e,t,n){"use strict";var r=n(4),a=n.n(r),s=n(5),i=n.n(s),o=n(6),u=n.n(o),c=n(7),l=n.n(c),p=n(23),d=n.n(p),h=n(8),m=n.n(h),f=n(9),v=n.n(f),g=n(0),y=n.n(g),E=n(50),b=n.n(E),C=n(12),k=n(51),w=n.n(k);function O(){var e=b()(["\n    mutation addMessage($message : MessageInput!) {\n        addMessage(message : $message) {\n            id\n            text\n            user {\n                id\n            }\n        }\n    }\n"]);return O=function(){return e},e}function P(){var e=b()(["\n    query chat($chatId: Int!) {\n        chat(chatId: $chatId) {\n            id\n            users {\n                id\n                avatar\n                username\n            }\n            messages {\n                id\n                text\n                user {\n                    id\n                }\n            }\n        }\n    }\n"]);return P=function(){return e},e}var I=w()(P()),x=w()(O()),A=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return m()(t,e),i()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.chat;return y.a.createElement(C.Mutation,{update:function(e,t){var r=t.data.addMessage,a=e.readQuery({query:I,variables:{chatId:n.id}});a.chat.messages.push(r),e.writeQuery({query:I,variables:{chatId:n.id},data:a})},mutation:x},function(e){return y.a.Children.map(t,function(t){return y.a.cloneElement(t,{addMessage:e})})})}}]),t}(g.Component),S=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),v()(d()(n),"state",{value:""}),v()(d()(n),"handleKeyPress",function(e){var t=d()(n),r=n.props,a=r.chat,s=r.addMessage;"Enter"===e.key&&n.state.value.length&&s({variables:{message:{text:n.state.value,chatId:a.id}}}).then(function(){t.setState({value:""})})}),v()(d()(n),"onChangeChatInput",function(e){e.preventDefault(),n.setState({value:e.target.value})}),n}return m()(t,e),i()(t,[{key:"render",value:function(){return y.a.createElement("div",{className:"input"},y.a.createElement("input",{type:"text",value:this.state.value,onChange:this.onChangeChatInput,onKeyPress:this.handleKeyPress}))}}]),t}(g.Component),M=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return m()(t,e),i()(t,[{key:"render",value:function(){var e=this.props,t=e.chat,n=e.closeChat;e.user;return y.a.createElement("div",{className:"chatWindow"},y.a.createElement("div",{className:"header"},y.a.createElement("span",null,t.users[1].username),y.a.createElement("button",{className:"close",onClick:function(){return n(t.id)}},"X")),y.a.createElement("div",{className:"messages"},t.messages.map(function(e,t){return y.a.createElement("div",{key:"message"+e.id,className:"message "+(e.user.id>1?"left":"right")},e.text)})),y.a.createElement(A,{chat:t},y.a.createElement(S,{chat:t})))}}]),t}(g.Component),N=n(2),$=n.n(N),j=n(16),q=n(63);function L(){var e=b()(["\n  query chat($chatId: Int!) {\n    chat(chatId: $chatId) {\n      id\n      users {\n        id\n        avatar\n        username\n      }\n      messages {\n        id\n        text\n        user {\n            id\n        }\n      }\n    }\n  }\n"]);return L=function(){return e},e}var F=w()(L()),_=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return m()(t,e),i()(t,[{key:"getVariables",value:function(){var e=this.props.variables,t={};return"undefined"!==$()(e.chatId)&&(t.chatId=e.chatId),t}},{key:"render",value:function(){var e=this.props.children,t=this.getVariables();return y.a.createElement(C.Query,{query:F,variables:t},function(t){var n=t.loading,r=t.error,a=t.data;if(n)return y.a.createElement(j.a,null);if(r)return y.a.createElement(q.a,null,y.a.createElement("p",null,r.message));var s=a.chat;return y.a.Children.map(e,function(e){return y.a.cloneElement(e,{chat:s})})})}}]),t}(g.Component);function D(){var e=b()(["\n  query chats { \n    chats {\n      id\n      users {\n        id\n        avatar\n        username\n      }\n      lastMessage {\n        text\n      }\n    }\n  }\n"]);return D=function(){return e},e}var T=w()(D()),Q=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return m()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return y.a.createElement(C.Query,{query:T},function(t){var n=t.loading,r=t.error,a=t.data,s=t.subscribeToMore;if(n)return y.a.createElement(j.a,null);if(r)return y.a.createElement(q.a,null,y.a.createElement("p",null,r.message));var i=a.chats;return y.a.Children.map(e,function(e){return y.a.cloneElement(e,{chats:i,subscribeToMore:s})})})}}]),t}(g.Component),U=n(52),R=n.n(U);function W(){var e=b()(["\n  subscription onMessageAdded {\n    messageAdded {\n      id\n      text\n      chat {\n        id\n      }\n      user {\n        id\n        __typename\n      }\n      __typename\n    }\n  }\n"]);return W=function(){return e},e}var H=w()(W()),V=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),v()(d()(n),"subscribeToNewMessages",function(){var e=d()(n),t=n.props.user;n.props.subscribeToMore({document:H,updateQuery:function(n,r){var a=r.subscriptionData;if(!a.data||!n.chats.length)return n;for(var s=-1,i=0;i<n.chats.length;i++)if(n.chats[i].id==a.data.messageAdded.chat.id){s=i;break}if(-1===s)return n;var o=Object.assign({},n.chats[i],{lastMessage:{text:a.data.messageAdded.text,__typename:a.data.messageAdded.__typename}}),u={chats:R()(n.chats)};u.chats[i]=o;try{var c=e.props.client.store.cache.readQuery({query:GET_CHAT,variables:{chatId:a.data.messageAdded.chat.id}});t.id!==a.data.messageAdded.user.id&&(c.chat.messages.push(a.data.messageAdded),e.props.client.store.cache.writeQuery({query:GET_CHAT,variables:{chatId:a.data.messageAdded.chat.id},data:c}))}catch(e){}return u}})}),v()(d()(n),"usernamesToString",function(e){for(var t=n.props.user,r="",a=0;a<e.length;a++)e[a].username!==t.username&&(r+=e[a].username),a-1===e.length&&(r+=", ");return r}),v()(d()(n),"getAvatar",function(e){var t=n.props.user;return e.length>2?"/public/group.png":e[0].id!==t.id?e[0].avatar:e[1].avatar}),n}return m()(t,e),i()(t,[{key:"componentDidMount",value:function(){this.subscribeToNewMessages()}},{key:"shorten",value:function(e){return e.length?e.length>12?e.substring(0,e.length-9)+"...":e:""}},{key:"render",value:function(){var e=this,t=this.props.chats;return y.a.createElement("div",{className:"chats"},t.map(function(t,n){return y.a.createElement("div",{key:"chat"+t.id,className:"chat",onClick:function(){return e.props.openChat(t.id)}},y.a.createElement("div",{className:"header"},y.a.createElement("img",{src:e.getAvatar(t.users)}),y.a.createElement("div",null,y.a.createElement("h2",null,e.shorten(e.usernamesToString(t.users))),y.a.createElement("span",null,t.lastMessage&&e.shorten(t.lastMessage.text)))))}))}}]),t}(g.Component),K=Object(C.withApollo)(V),G=n(53);function B(){var e=b()(["\n  subscription onMessageAdded {\n    messageAdded {\n      id \n      text\n      chat {\n        id\n      }\n      user {\n        id\n        __typename\n      }\n      __typename\n    }\n  }\n"]);return B=function(){return e},e}var X=w()(B()),z=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return m()(t,e),i()(t,[{key:"render",value:function(){var e=this.props.children;return y.a.createElement(C.Subscription,{subscription:X},function(t){var n=t.data;return y.a.Children.map(e,function(e){return y.a.cloneElement(e,{data:n})})})}}]),t}(g.Component),J=function(e){function t(){return a()(this,t),u()(this,l()(t).apply(this,arguments))}return m()(t,e),i()(t,[{key:"componentWillReceiveProps",value:function(e){"undefined"!==$()(e.data)&&"undefined"!==$()(e.data.messageAdded)&&e.data&&e.data.messageAdded&&Object(G.toast)(e.data.messageAdded.text,{position:G.toast.POSITION.TOP_LEFT})}},{key:"render",value:function(){return null}}]),t}(g.Component);n.d(t,"a",function(){return Y});var Y=function(e){function t(){var e,n;a()(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(s))),v()(d()(n),"state",{openChats:[]}),v()(d()(n),"openChat",function(e){var t=n.state.openChats.slice();-1===t.indexOf(e)&&(t.length>2&&(t=t.slice(1)),t.push(e)),n.setState({openChats:t})}),v()(d()(n),"closeChat",function(e){var t=n.state.openChats.slice(),r=t.indexOf(e);t.splice(r,1),n.setState({openChats:t})}),n}return m()(t,e),i()(t,[{key:"render",value:function(){var e=this,t=this.props.user,n=this.state.openChats;return y.a.createElement("div",{className:"wrapper"},y.a.createElement(G.ToastContainer,null),y.a.createElement(z,null,y.a.createElement(J,null)),y.a.createElement(Q,null,y.a.createElement(K,{openChat:this.openChat,user:t})),y.a.createElement("div",{className:"openChats"},n.map(function(n,r){return y.a.createElement(_,{key:"chatWindow"+n,variables:{chatId:n}},y.a.createElement(M,{closeChat:e.closeChat,user:t}))})))}}]),t}(g.Component)},70:function(e,t,n){"use strict";var r=n(52),a=n.n(r),s=n(4),i=n.n(s),o=n(5),u=n.n(o),c=n(6),l=n.n(c),p=n(7),d=n.n(p),h=n(23),m=n.n(h),f=n(8),v=n.n(f),g=n(9),y=n.n(g),E=n(0),b=n.n(E),C=n(54),k=n.n(C),w=n(55),O=n(46),P=function(e){function t(){var e,n;i()(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(a))),y()(m()(n),"state",{show:!1}),y()(m()(n),"handleClick",function(){var e=n.state.show;n.setState({show:!e},function(){e?document.removeEventListener("click",n.handleClick):document.addEventListener("click",n.handleClick)})}),n}return v()(t,e),u()(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleClick,!0)}},{key:"render",value:function(){var e=this.props,t=e.trigger,n=e.children,r=this.state.show;return b.a.createElement("div",{className:"dropdown"},b.a.createElement("div",null,b.a.createElement("div",{className:"trigger",onClick:this.handleClick},t),r&&b.a.createElement("div",{className:"content"},n)))}}]),t}(E.Component),I=n(2),x=n.n(I),A=n(50),S=n.n(A),M=n(12),N=n(51),$=n.n(N);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function q(){var e=S()(["\n    mutation deletePost($postId : Int!) {\n        deletePost(postId : $postId) {\n            success\n        }\n    }\n"]);return q=function(){return e},e}function L(){var e=S()(["\n    query postsFeed($page: Int, $limit: Int) { \n        postsFeed(page: $page, limit: $limit) { \n            posts {\n                id\n                text\n                user {\n                    avatar\n                    username\n                }\n            }\n        }\n    }\n"]);return L=function(){return e},e}var F=$()(L()),_=$()(q()),D=function(e){function t(){return i()(this,t),l()(this,d()(t).apply(this,arguments))}return v()(t,e),u()(t,[{key:"render",value:function(){var e=this.props.children,t=this.props.post.id,n={page:0,limit:10};return b.a.createElement(M.Mutation,{update:function(e,r){if(r.data.deletePost.success){var a={query:F};"undefined"!==x()(n)&&(a.variables=n);for(var s=e.readQuery(a),i=0;i<s.postsFeed.posts.length&&s.postsFeed.posts[i].id!==t;i++);s.postsFeed.posts.splice(i,1),e.writeQuery(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach(function(t){y()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},a,{data:s}))}},mutation:_},function(n){return b.a.Children.map(e,function(e){return b.a.cloneElement(e,{deletePost:n,postId:t})})})}}]),t}(E.Component),T=function(e){var t=e.deletePost,n=e.postId;return b.a.createElement("button",{onClick:function(){t({variables:{postId:n}})}},"Delete")},Q=function(e){var t=e.post,n=e.changeState;return b.a.createElement("div",{className:"header"},b.a.createElement(O.Link,{to:"/user/"+t.user.username},b.a.createElement("img",{src:t.user.avatar}),b.a.createElement("div",null,b.a.createElement("h2",null,t.user.username))),b.a.createElement(P,{trigger:b.a.createElement(w.FontAwesomeIcon,{icon:"angle-down"})},b.a.createElement("button",{onClick:n},"Edit"),b.a.createElement(D,{post:t},b.a.createElement(T,null))))},U=function(e){var t=e.post;return b.a.createElement("p",{className:"content"},t.text)},R=n(66);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function H(){var e=S()(["\nmutation updatePost($post : PostInput!, $postId : Int!) {\n    updatePost(post : $post, postId : $postId) {\n        id\n        text\n    }\n}"]);return H=function(){return e},e}function V(){var e=S()(["\n  query postsFeed($page: Int, $limit: Int) { \n    postsFeed(page: $page, limit: $limit) { \n      posts {\n        id\n        text\n        user {\n          avatar\n          username\n        }\n      }\n    }\n  }\n"]);return V=function(){return e},e}var K=$()(V()),G=$()(H()),B=function(e){function t(){var e,n;i()(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(a))),y()(m()(n),"state",{postContent:n.props.post.text}),y()(m()(n),"changePostContent",function(e){n.setState({postContent:e})}),n}return v()(t,e),u()(t,[{key:"render",value:function(){var e=this,t=this.props.children,n=this.state.postContent,r=this.props.post.id,a={page:0,limit:10};return b.a.createElement(M.Mutation,{update:function(e,t){var n=t.data.updatePost,s={query:K};"undefined"!==x()(a)&&(s.variables=a);for(var i=e.readQuery(s),o=0;o<i.postsFeed.posts.length;o++)if(i.postsFeed.posts[o].id===r){i.postsFeed.posts[o].text=n.text;break}e.writeQuery(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach(function(t){y()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},s,{data:i}))},optimisticResponse:{__typename:"Mutation",updatePost:{__typename:"Post",text:n}},mutation:G},function(a){return b.a.Children.map(t,function(t){return b.a.cloneElement(t,{updatePost:a,postContent:n,postId:r,changePostContent:e.changePostContent})})})}}]),t}(E.Component),X=n(56),z=n.n(X),J=function(e){function t(){var e,n;i()(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(a))),y()(m()(n),"state",{editing:!1}),y()(m()(n),"changeState",function(){var e=n.state.editing;n.setState({editing:!e})}),n}return v()(t,e),u()(t,[{key:"render",value:function(){var e=this.props.post,t=this.state.editing;return b.a.createElement("div",{className:"post "+(e.id<0?"optimistic":"")},b.a.createElement(Q,{post:e,changeState:this.changeState}),!t&&b.a.createElement(U,{post:e}),t&&b.a.createElement(B,{post:e},b.a.createElement(R.a,{changeState:this.changeState})))}}]),t}(E.Component);y()(J,"propTypes",{post:z.a.shape({id:z.a.number.isRequired,text:z.a.string.isRequired,user:z.a.shape({avatar:z.a.string.isRequired,username:z.a.string.isRequired}).isRequired}).isRequired}),n.d(t,"a",function(){return Y});var Y=function(e){function t(){var e,n;i()(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(s))),y()(m()(n),"state",{page:0,hasMore:!0}),y()(m()(n),"loadMore",function(e){var t=m()(n),r=n.state.page;e({variables:{page:r+1},updateQuery:function(e,n){var s=n.fetchMoreResult;return s.postsFeed.posts.length?(t.setState({page:r+1}),{postsFeed:{__typename:"PostFeed",posts:[].concat(a()(e.postsFeed.posts),a()(s.postsFeed.posts))}}):(t.setState({hasMore:!1}),e)}})}),n}return v()(t,e),u()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.posts,r=t.fetchMore,a=this.state.hasMore;return b.a.createElement("div",{className:"feed"},b.a.createElement(k.a,{loadMore:function(){return e.loadMore(r)},hasMore:a,loader:b.a.createElement("div",{className:"loader",key:"loader"},"Loading ...")},n.map(function(e,t){return b.a.createElement(J,{key:e.id,post:e})})))}}]),t}(E.Component)}};